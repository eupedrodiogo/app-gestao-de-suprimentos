<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualiza√ß√µes & Dashboards - Sistema de Gest√£o de Suprimentos</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link href="css/global-styles.css" rel="stylesheet">
    <link href="css/main.css" rel="stylesheet">
    <link href="css/components/icons.css" rel="stylesheet">
    
    <style>
        .visualization-card {
            transition: transform 0.2s, box-shadow 0.2s;
            border: none;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .visualization-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        
        .chart-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .dashboard-card {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .report-card {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }
        
        .visualization-section {
            margin-bottom: 40px;
        }
        
        .section-header {
            border-left: 4px solid #007bff;
            padding-left: 15px;
            margin-bottom: 25px;
        }
        
        .chart-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .dashboard-preview {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }
        
        .chart-controls {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .loading-spinner {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .export-btn {
            margin: 5px;
        }
        
        .chart-type-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        
        .chart-type-btn {
            padding: 10px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .chart-type-btn:hover,
        .chart-type-btn.active {
            border-color: #007bff;
            background: #007bff;
            color: white;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                üìä Visualiza√ß√µes & Dashboards
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="dashboard.html">
                            <svg class="icon-sm me-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                <line x1="9" y1="9" x2="9" y2="21"/>
                                <line x1="15" y1="9" x2="15" y2="21"/>
                            </svg>
                            Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="analytics.html">
                            <svg class="icon-sm me-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="22,12 18,12 15,21 9,3 6,12 2,12"/>
                            </svg>
                            Analytics
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="predictions.html">
                            <svg class="icon-sm me-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 6v6l4 2"/>
                            </svg>
                            Predi√ß√µes
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="visualizations.html">
                            <svg class="icon-sm me-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="18" y1="20" x2="18" y2="10"/>
                                <line x1="12" y1="20" x2="12" y2="4"/>
                                <line x1="6" y1="20" x2="6" y2="14"/>
                            </svg>
                            Visualiza√ß√µes
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="automation.html">
                            <svg class="icon-sm me-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="3"/>
                                <path d="M12 1v6m0 6v6m11-7h-6m-6 0H1m15.5-6.5l-4.24 4.24M7.76 7.76L3.52 3.52m12.96 12.96l-4.24-4.24M7.76 16.24l-4.24 4.24"/>
                            </svg>
                            Automa√ß√£o
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mt-5 pt-4">
        <!-- Page Header -->
        <div class="row mb-4">
            <div class="col-12">
                <h1>
                    <svg class="icon-lg me-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="20" x2="18" y2="10"/>
                        <line x1="12" y1="20" x2="12" y2="4"/>
                        <line x1="6" y1="20" x2="6" y2="14"/>
                    </svg>
                    Visualiza√ß√µes & Dashboards
                </h1>
                <p class="text-muted">Crie e personalize dashboards e visualiza√ß√µes de dados</p>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">
                            <svg class="icon-sm me-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2"/>
                            </svg>
                            A√ß√µes R√°pidas
                        </h5>
                        <div class="d-flex flex-wrap gap-2">
                            <button class="btn btn-primary" onclick="generateQuickDashboard()">
                                <svg class="icon-sm me-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                    <line x1="9" y1="9" x2="9" y2="21"/>
                                    <line x1="15" y1="9" x2="15" y2="21"/>
                                </svg>
                                Dashboard R√°pido
                            </button>
                            <button class="btn btn-success" onclick="exportCurrentView()">
                                <svg class="icon-sm me-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                    <polyline points="7,10 12,15 17,10"/>
                                    <line x1="12" y1="15" x2="12" y2="3"/>
                                </svg>
                                Exportar Visualiza√ß√£o
                            </button>
                            <button class="btn btn-info" onclick="shareVisualization()">
                                <svg class="icon-sm me-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/>
                                    <polyline points="16,6 12,2 8,6"/>
                                    <line x1="12" y1="2" x2="12" y2="15"/>
                                </svg>
                                Compartilhar
                            </button>
                            <button class="btn btn-warning" onclick="resetVisualization()">
                                <svg class="icon-sm me-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="23,4 23,10 17,10"/>
                                    <polyline points="1,20 1,14 7,14"/>
                                    <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"/>
                                </svg>
                                Resetar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Visualization Tools -->
        <div class="visualization-section">
            <div class="section-header">
                <h3>Geradores de Visualiza√ß√£o</h3>
                <p class="text-muted mb-0">Ferramentas para criar gr√°ficos e dashboards personalizados</p>
            </div>
            
            <div class="row">
                <div class="col-md-6 mb-4">
                    <div class="card visualization-card h-100">
                        <div class="card-body text-center">
                            <svg class="icon-xl mb-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="18" y1="20" x2="18" y2="10"/>
                                <line x1="12" y1="20" x2="12" y2="4"/>
                                <line x1="6" y1="20" x2="6" y2="14"/>
                            </svg>
                            <h5 class="card-title mt-3">Gr√°ficos Din√¢micos</h5>
                            <p class="card-text">Crie gr√°ficos interativos com dados em tempo real</p>
                            <button class="btn btn-light" onclick="openChartBuilder()">
                                <svg class="icon-sm me-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="5" x2="12" y2="19"/>
                                    <line x1="5" y1="12" x2="19" y2="12"/>
                                </svg>
                                Criar Gr√°fico
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6 mb-4">
                    <div class="card visualization-card chart-card h-100">
                        <div class="card-body text-center">
                            <svg class="icon-xl mb-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                <line x1="9" y1="9" x2="9" y2="21"/>
                                <line x1="15" y1="9" x2="15" y2="21"/>
                            </svg>
                            <h5 class="card-title mt-3">Dashboard Personalizado</h5>
                            <p class="card-text">Monte seu pr√≥prio dashboard com widgets</p>
                            <button class="btn btn-light" onclick="openDashboardBuilder()">
                                <svg class="icon-sm me-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                    <rect x="7" y="7" width="3" height="3"/>
                                    <rect x="14" y="7" width="3" height="3"/>
                                    <rect x="7" y="14" width="3" height="3"/>
                                    <rect x="14" y="14" width="3" height="3"/>
                                </svg>
                                Construir Dashboard
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6 mb-4">
                    <div class="card visualization-card dashboard-card h-100">
                        <div class="card-body text-center">
                            <svg class="icon-xl mb-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                <polyline points="14,2 14,8 20,8"/>
                                <line x1="16" y1="13" x2="8" y2="13"/>
                                <line x1="16" y1="17" x2="8" y2="17"/>
                                <polyline points="10,9 9,9 8,9"/>
                            </svg>
                            <h5 class="card-title mt-3">Relat√≥rios Visuais</h5>
                            <p class="card-text">Gere relat√≥rios com gr√°ficos e tabelas</p>
                            <button class="btn btn-light" onclick="generateVisualReport()">
                                <svg class="icon-sm me-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                    <polyline points="14,2 14,8 20,8"/>
                                    <line x1="16" y1="13" x2="8" y2="13"/>
                                    <line x1="16" y1="17" x2="8" y2="17"/>
                                </svg>
                                Gerar Relat√≥rio
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6 mb-4">
                    <div class="card visualization-card report-card h-100">
                        <div class="card-body text-center">
                            <svg class="icon-xl mb-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                                <circle cx="12" cy="10" r="3"/>
                            </svg>
                            <h5 class="card-title mt-3">Mapas de Calor</h5>
                            <p class="card-text">Visualize dados geogr√°ficos e de densidade</p>
                            <button class="btn btn-light" onclick="createHeatmap()">
                                <svg class="icon-sm me-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"/>
                                    <line x1="2" y1="12" x2="22" y2="12"/>
                                    <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
                                </svg>
                                Criar Mapa
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chart Builder -->
        <div class="chart-controls" id="chartControls" style="display: none;">
            <h5>üîß Construtor de Gr√°ficos</h5>
            
            <div class="row">
                <div class="col-md-6">
                    <label class="form-label">Tipo de Gr√°fico</label>
                    <div class="chart-type-selector">
                        <div class="chart-type-btn active" data-type="bar">
                            üìä Barras
                        </div>
                        <div class="chart-type-btn" data-type="line">
                            üìà Linha
                        </div>
                        <div class="chart-type-btn" data-type="pie">
                            ü•ß Pizza
                        </div>
                        <div class="chart-type-btn" data-type="doughnut">
                            üç© Rosca
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <label class="form-label">Fonte de Dados</label>
                    <select class="form-select" id="dataSource">
                        <option value="products">Produtos</option>
                        <option value="suppliers">Fornecedores</option>
                        <option value="orders">Pedidos</option>
                        <option value="quotes">Cota√ß√µes</option>
                    </select>
                </div>
            </div>
            
            <div class="row mt-3">
                <div class="col-md-6">
                    <label class="form-label">Campo X</label>
                    <select class="form-select" id="xField">
                        <option value="category">Categoria</option>
                        <option value="supplier">Fornecedor</option>
                        <option value="date">Data</option>
                        <option value="status">Status</option>
                    </select>
                </div>
                
                <div class="col-md-6">
                    <label class="form-label">Campo Y</label>
                    <select class="form-select" id="yField">
                        <option value="count">Quantidade</option>
                        <option value="value">Valor</option>
                        <option value="price">Pre√ßo</option>
                        <option value="stock">Estoque</option>
                    </select>
                </div>
            </div>
            
            <div class="mt-3">
                <button class="btn btn-primary" onclick="generateChart()">
                    üìà Gerar Gr√°fico
                </button>
                <button class="btn btn-secondary" onclick="hideChartBuilder()">
                    ‚ùå Cancelar
                </button>
            </div>
        </div>

        <!-- Loading Spinner -->
        <div class="loading-spinner" id="loadingSpinner">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Gerando visualiza√ß√£o...</span>
            </div>
            <p class="mt-2">Criando visualiza√ß√£o...</p>
        </div>

        <!-- Charts Display -->
        <div class="visualization-section">
            <div class="section-header">
                <h3>Visualiza√ß√µes Ativas</h3>
                <p class="text-muted mb-0">Gr√°ficos e dashboards gerados</p>
            </div>
            
            <div class="row" id="chartsContainer">
                <div class="col-md-6">
                    <div class="chart-container">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5>Produtos por Categoria</h5>
                            <div>
                                <button class="btn btn-sm btn-outline-primary export-btn" onclick="exportChart('categoryChart')">
                                    üì•
                                </button>
                                <button class="btn btn-sm btn-outline-secondary export-btn" onclick="fullscreenChart('categoryChart')">
                                    üîç
                                </button>
                            </div>
                        </div>
                        <canvas id="categoryChart" width="400" height="200"></canvas>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="chart-container">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5>Vendas Mensais</h5>
                            <div>
                                <button class="btn btn-sm btn-outline-primary export-btn" onclick="exportChart('salesChart')">
                                    üì•
                                </button>
                                <button class="btn btn-sm btn-outline-secondary export-btn" onclick="fullscreenChart('salesChart')">
                                    üîç
                                </button>
                            </div>
                        </div>
                        <canvas id="salesChart" width="400" height="200"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dashboard Preview -->
        <div class="dashboard-preview" id="dashboardPreview">
            <h4>Preview do Dashboard</h4>
            <div class="row">
                <div class="col-md-8">
                    <div class="chart-container">
                        <h5>Gr√°fico Principal</h5>
                        <canvas id="mainChart" width="600" height="300"></canvas>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="chart-container">
                        <h5>M√©tricas</h5>
                        <div class="row">
                            <div class="col-12 mb-3">
                                <div class="text-center p-3 bg-primary text-white rounded">
                                    <h3 id="metric1">150</h3>
                                    <small>Total de Produtos</small>
                                </div>
                            </div>
                            <div class="col-12 mb-3">
                                <div class="text-center p-3 bg-success text-white rounded">
                                    <h3 id="metric2">25</h3>
                                    <small>Fornecedores Ativos</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <div id="toast" class="toast" role="alert">
            <div class="toast-header">
                <strong class="me-auto" id="toastTitle">Notifica√ß√£o</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
            </div>
            <div class="toast-body" id="toastMessage">
                Mensagem
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="js/global-functions.js"></script>
    <script src="js/mobile-menu.js"></script>
    
    <script>
        let currentCharts = {};
        let selectedChartType = 'bar';

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            initializeDefaultCharts();
            setupChartTypeSelectors();
        });

        // Setup chart type selectors
        function setupChartTypeSelectors() {
            document.querySelectorAll('.chart-type-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.chart-type-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    selectedChartType = this.dataset.type;
                });
            });
        }

        // Initialize default charts
        function initializeDefaultCharts() {
            // Category Chart
            const categoryCtx = document.getElementById('categoryChart').getContext('2d');
            currentCharts.categoryChart = new Chart(categoryCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Eletr√¥nicos', 'Ferramentas', 'Materiais', 'Equipamentos'],
                    datasets: [{
                        data: [30, 25, 20, 25],
                        backgroundColor: ['#007bff', '#28a745', '#ffc107', '#dc3545']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // Sales Chart
            const salesCtx = document.getElementById('salesChart').getContext('2d');
            currentCharts.salesChart = new Chart(salesCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
                    datasets: [{
                        label: 'Vendas (R$)',
                        data: [12000, 19000, 15000, 25000, 22000, 30000],
                        borderColor: '#007bff',
                        backgroundColor: 'rgba(0, 123, 255, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'R$ ' + value.toLocaleString('pt-BR');
                                }
                            }
                        }
                    }
                }
            });
        }

        // Visualization functions
        function openChartBuilder() {
            document.getElementById('chartControls').style.display = 'block';
            document.getElementById('chartControls').scrollIntoView({ behavior: 'smooth' });
        }

        function hideChartBuilder() {
            document.getElementById('chartControls').style.display = 'none';
        }

        function openDashboardBuilder() {
            const preview = document.getElementById('dashboardPreview');
            preview.style.display = 'block';
            preview.scrollIntoView({ behavior: 'smooth' });
            
            // Initialize main chart in preview
            setTimeout(() => {
                const mainCtx = document.getElementById('mainChart').getContext('2d');
                new Chart(mainCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Q1', 'Q2', 'Q3', 'Q4'],
                        datasets: [{
                            label: 'Receita',
                            data: [65000, 75000, 85000, 95000],
                            backgroundColor: '#007bff'
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return 'R$ ' + value.toLocaleString('pt-BR');
                                    }
                                }
                            }
                        }
                    }
                });
            }, 100);
            
            showToast('Dashboard personalizado carregado!', 'success');
        }

        function generateChart() {
            const loadingSpinner = document.getElementById('loadingSpinner');
            
            try {
                loadingSpinner.style.display = 'block';
                
                // Simulate chart generation
                setTimeout(() => {
                    loadingSpinner.style.display = 'none';
                    hideChartBuilder();
                    
                    // Add new chart to container
                    addNewChart();
                    
                    showToast('Gr√°fico gerado com sucesso!', 'success');
                }, 2000);
                
            } catch (error) {
                loadingSpinner.style.display = 'none';
                showToast('Erro ao gerar gr√°fico: ' + error.message, 'error');
            }
        }

        function addNewChart() {
            const container = document.getElementById('chartsContainer');
            const chartId = 'chart_' + Date.now();
            
            const chartHtml = `
                <div class="col-md-6">
                    <div class="chart-container">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5>Gr√°fico Personalizado</h5>
                            <div>
                                <button class="btn btn-sm btn-outline-primary export-btn" onclick="exportChart('${chartId}')">
                                    üì•
                                </button>
                                <button class="btn btn-sm btn-outline-danger export-btn" onclick="removeChart('${chartId}')">
                                    üóëÔ∏è
                                </button>
                            </div>
                        </div>
                        <canvas id="${chartId}" width="400" height="200"></canvas>
                    </div>
                </div>
            `;
            
            container.insertAdjacentHTML('beforeend', chartHtml);
            
            // Initialize the new chart
            setTimeout(() => {
                const ctx = document.getElementById(chartId).getContext('2d');
                currentCharts[chartId] = new Chart(ctx, {
                    type: selectedChartType,
                    data: generateSampleData(),
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }, 100);
        }

        function generateSampleData() {
            const labels = ['Item A', 'Item B', 'Item C', 'Item D'];
            const data = labels.map(() => Math.floor(Math.random() * 100) + 10);
            
            return {
                labels: labels,
                datasets: [{
                    label: 'Dados',
                    data: data,
                    backgroundColor: ['#007bff', '#28a745', '#ffc107', '#dc3545']
                }]
            };
        }

        function generateVisualReport() {
            showToast('Gerando relat√≥rio visual...', 'info');
            
            setTimeout(() => {
                // Simulate report generation
                const reportWindow = window.open('', '_blank');
                reportWindow.document.write(`
                    <html>
                        <head>
                            <title>Relat√≥rio Visual</title>
                            <style>
                                body { font-family: Arial, sans-serif; margin: 20px; }
                                .header { text-align: center; margin-bottom: 30px; }
                                .chart-section { margin: 20px 0; }
                            </style>
                        </head>
                        <body>
                            <div class="header">
                                <h1>Relat√≥rio Visual - Sistema de Gest√£o</h1>
                                <p>Gerado em: ${new Date().toLocaleDateString('pt-BR')}</p>
                            </div>
                            <div class="chart-section">
                                <h2>Resumo Executivo</h2>
                                <p>Este relat√≥rio apresenta as principais m√©tricas e visualiza√ß√µes do sistema.</p>
                            </div>
                        </body>
                    </html>
                `);
                reportWindow.document.close();
                
                showToast('Relat√≥rio visual gerado!', 'success');
            }, 1500);
        }

        function createHeatmap() {
            showToast('Funcionalidade de mapa de calor em desenvolvimento', 'info');
        }

        function generateQuickDashboard() {
            openDashboardBuilder();
        }

        function exportChart(chartId) {
            if (currentCharts[chartId]) {
                const link = document.createElement('a');
                link.download = `${chartId}.png`;
                link.href = currentCharts[chartId].toBase64Image();
                link.click();
                
                showToast('Gr√°fico exportado com sucesso!', 'success');
            }
        }

        function removeChart(chartId) {
            if (currentCharts[chartId]) {
                currentCharts[chartId].destroy();
                delete currentCharts[chartId];
                document.getElementById(chartId).closest('.col-md-6').remove();
                
                showToast('Gr√°fico removido!', 'info');
            }
        }

        function fullscreenChart(chartId) {
            showToast('Modo tela cheia em desenvolvimento', 'info');
        }

        function exportCurrentView() {
            showToast('Exportando visualiza√ß√£o atual...', 'info');
        }

        function shareVisualization() {
            showToast('Funcionalidade de compartilhamento em desenvolvimento', 'info');
        }

        function resetVisualization() {
            // Reset all custom charts
            Object.keys(currentCharts).forEach(chartId => {
                if (chartId !== 'categoryChart' && chartId !== 'salesChart') {
                    removeChart(chartId);
                }
            });
            
            // Hide dashboard preview
            document.getElementById('dashboardPreview').style.display = 'none';
            hideChartBuilder();
            
            showToast('Visualiza√ß√µes resetadas!', 'info');
        }

        // Toast function
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            const toastTitle = document.getElementById('toastTitle');
            const toastMessage = document.getElementById('toastMessage');
            
            toastTitle.textContent = type === 'success' ? 'Sucesso' : type === 'error' ? 'Erro' : 'Informa√ß√£o';
            toastMessage.textContent = message;
            
            const bsToast = new bootstrap.Toast(toast);
            bsToast.show();
        }
    </script>
    <script src="js/components/icons.js"></script>
</body>
</html>